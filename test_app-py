import streamlit as st
import openai
import os

st.set_page_config(page_title="Test OpenAI", page_icon="‚ö°")

st.title("‚ö° Test OpenAI minimal")

# --- cl√© API
api_key = os.environ.get("OPENAI_API_KEY")
if not api_key:
    st.error("‚ö†Ô∏è Aucune cl√© API trouv√©e. Ajoutez OPENAI_API_KEY dans les Secrets Streamlit Cloud.")
    st.stop()
openai.api_key = api_key

# --- simple champ de texte
question = st.text_input("√âcris ton id√©e :", "Chat qui parle")

if st.button("ü™Ñ G√©n√©rer un texte"):
    with st.spinner("L'IA √©crit..."):
        try:
            response = openai.ChatCompletion.create(
                model="gpt-4o-mini",
                messages=[
                    {"role": "system", "content": "Tu es un assistant cr√©atif pour enfants."},
                    {"role": "user", "content": f"Cr√©e une petite histoire pour enfants avec : {question}"}
                ],
                temperature=0.8,
                max_tokens=300
            )
            story = response["choices"][0]["message"]["content"].strip()
            st.success("‚ú® R√©sultat")
            st.write(story)
        except Exception as e:
            st.error(f"Erreur : {e}")
